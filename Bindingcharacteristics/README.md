# Peakfeatures_graphs.Rmd

Simple code to visualise differences in avg peak width and area covered under peaks for different DNA-binding proteins (Bacterial NAPs vs TFs vs Halophilic histones vs Halophilic TFs). The input to this is Table S3 of the paper (also uploaded here). Information within this table was obtained from peak lists generated by Mosaics (as shown in the Peakcalling subfolder), with elementary processing in order to get peak width and total bases covered done within Excel. The number of bases covered was then expressed as a percentage of the total size of the genome to get a comparable number of coverage across species. This code uses simple ggplot2 commands to generate graphs from this data.

Input dependency: TableS3_peakcharacteristics.xlsx

Library depepdency: ggplot2_3.3.5 readxl_1.3.1

# Annotatepeaksandclassify.Rmd:

This is a modified version of code written by Rylee Hackley and Amy Schmid.

Takes a peak list; annotates each peak with the nearest feature (promoter or gene), and thus classifies each peak as belonging to coding or promoter regions. Further details are included within the code itself.

Input dependencies:

HstA_curatedlist.bed (a peak list for Hfx volcanii HstA in .bed format)

20181113_hvol_GCF_000025685.1_ASM2568v1_genomic.gff (GFF file from NCBI containing gene information for Hfx volcanii)

20181113_hvol_GCF_000025685.1_ASM2568v1_genomic.gff.key (modification of the GFF file containing important information)


Library dependencies:
rapportools_1.0 
tidyverse_1.3.1 
forcats_0.5.1 
GenomicRanges_1.42.0 
GenomicFeatures_1.42.3 
openxlsx_4.2.4 
IRanges_2.24.1 
rtracklayer_1.50.0 
AnnotationHub_2.22.1 
dplyr_1.0.7 

# Peaklocation_newplot.Rmd

Simple code that generates bar plots from information about percentage of genes in promoter region.

That information is generated from the code above (Annotatepeaksandclassify.Rmd) for multiple proteins (including HstA, HpyA, other halophilic TFs). The output is stored in Peaklocations.xlsx. Relative enrichment of these peaks in promoter regions was calculated using a hypergeomtric test (results in Table S5 of the paper). These p-values were also added to Peaklocations.xlsx. Finally, the code manually takes in the percentage of the relevant genome that is intergenic.

Library dependencies:

forcats_0.5.1 ggplot2_3.3.5 readxl_1.3.1
