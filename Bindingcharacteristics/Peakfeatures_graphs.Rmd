---
title: "Peakfeatures_graphs"
author: "Saaz Sakrikar"
date: "11/13/2021"
output: html_document
---

Creates dot plots comparing avg peak width and%age of the genome covered by peaks, for halophilic histones vs halophilic TFs vs bacterial TFs vs bacterial NAPs.
Restricted to those where I could make reliable peak lists using Mosaics.
Avg peak widths and area covered by peaks is obtained simply using Excel and stored in Table S3 (which is the input for this code).

```{r setup}
library(readxl)
library(ggplot2)

Peakcharacteristics=read_excel("TableS3_peakcharacteristics.xlsx",sheet = "TableS3")
```


```{r plotting}
#Average widfth of peaks
ggplot(Peakcharacteristics,aes(x=Type_of_protein,y=Avg_width))+geom_dotplot(alpha=0.8,binaxis="y",stackdir="center",aes(fill=Protein,color=Protein))+stat_summary(fun=median,fun.min=median,fun.max=median,geom="crossbar",width=0.5)+theme_bw()+scale_fill_manual(values=c("khaki4","blueviolet","black","darkblue","cornflowerblue","forestgreen","palevioletred","palevioletred","palevioletred"))+scale_color_manual(values=c("khaki4","blueviolet","black","darkblue","cornflowerblue","forestgreen","palevioletred","palevioletred","palevioletred"))+ylim(c(0,2000))

#Percentage of genome covered by binding peaks
ggplot(Peakcharacteristics,aes(x=Type_of_protein,y=Percent_covered))+geom_dotplot(alpha=0.8,binaxis="y",binwidth=1,stackdir="center",aes(fill=Protein,color=Protein))+stat_summary(fun=median,fun.min=median,fun.max=median,geom="crossbar",width=0.5)+theme_bw()+ylim(c(0,25))+scale_fill_manual(values=c("khaki4","blueviolet","black","darkblue","cornflowerblue","forestgreen","palevioletred","palevioletred","palevioletred"))+scale_color_manual(values=c("khaki4","blueviolet","black","darkblue","cornflowerblue","forestgreen","palevioletred","palevioletred","palevioletred"))


```

```{r session}
sessionInfo()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
